
--                                                                    @@%*                                                                                         
--                                                                  /@@@&/                                                                                         
--                                                                #@&@%(@                                                                                          
--                                                              .@@&@&%@,                                                                                          
--                                                             /@@@@&@&&                                                                                           
--                                                   ,,******.@@@&@@@@@ *@@                                                                                        
--                                             ,************&&@@@&%@@@@@@.                                                                                         
--                                          ,***********(**%@@@@&@@@@(@*                                                                                           
--                                        ,*,,,,**/@@@*&&&(@&&@@%&&@&&***                                                                                          
--                                       ,,,,,,,*@@@@/&@@&(@&&#@&&&,******                                                                                         
--                                     ,,,&@@@(@@@@@@/&@@&*####.,,,,,,,,,,*                                                                                        
--                                 @@@@@@@@@*#@&@@@@#(&@&@/(#(,,,,,,,,,,,,,*                                                                                       
--                             (@@@@@@@@@@@&@@&@@@@@#(&&%#(#,,.,,,.,,,,,,.,,,                                                                                      
--                        /@@@@@@@@@@@@@@@@@@%@@@@@###((/(..,,(,(,,,,,,,,,.,,,,                                                                                    
--                 ./@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@(#(((.,,(,#/(#..,,,,,,#,,,,,,,,                                                                                
--             %@@@@@@@@@@@@@@@@@@@@@@@@@&&&&###((/.....,,,.#,#&/&&/,,,,,,*(.,,,,,,*****.                                                                          
--           #@@@@@@@@@@@@@@@@@@@@@@&&&&&###..*.#(,,..,,...*(.. ..*%,*,,,,#...,,,,,,,*****************,,,,,*************.                                          
--          @@@@@@@@@@@@@@@@@@@@&&&&##/ ,.....,#/(*,,......%&@@,#&&#,,,,,.... .,,,,,,,,**,*****,,,,,,,,,,.........,*******,,,,***,                                 
--         @@@@@@@@@@@@@@@@&&&&%##,      ..,,..#&%,&#%&#&&&&&&&&&&&,,,,,.. ....,..,,,,.,,,,,,,,,,....,,,,,,,,*****************,,,,,,                               
--         @@@@@@@@@&&&&&&&&###&         .,,,.,(&&&@&@&@%@&@&@&@&&,,,,.. . ....,,,,......,,,,,,,,,,,,,,********,............,,,,, ,,.,                             
--          @@@@&&&&&&&&###*&&&&@*       ,*,....&&&@&&&&&#&@&&&&&****//&@@.,.....,,,,,,,,,,,,,,,,,,,,,*,,........... .,,,        ,  ,,,                            
--            %@@@/#####(&&@@@@@@@%#&&%&/**,......*&&&&@&&&@&/&#**,*###&&**,.. ........,,,,,,,,,,..............       ....,,         ,,,,                          
--               @@@@@@@@@@@@@@@@@@&%#&,***,...@@@@@/*&&&&&@&%****#(##&&#*,..(&&&@&%,.....................                ..,        ,,,,                          
--                #,(@@@@@@@@@@@@@@@@%****,...@@@@&&####((#,,*,,####&&&*,,./(&&&@@@@@@@@*...........        ..,,            ,,         ,                           
--                %&&&(#@@@@@@@@@@@@,%**,,,..&#@@@@@####(,,..,#,##%@&&*,./#&(&&&&&&@@@@@@@@                     .**         .,,       .                            
--                /#&&&@&&(##&&@@@@*@**,,..(/(%@@#(@&#(,,,/.,,*,#@&@,,.(#(@@@&//(##((&@@@@@                        **        ,                                     
--                 (@&@&/&#& /####,@*,,,.*((@@@/%@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#@@@@@@@@@@@@,                         ,                                             
--                   (@/&@&@@@%. #@@@@@@@@@@@@@@@%(((#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@(,,,                       .                                             
--                     %@&&@&@@&&@(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.,,,,,,.                      ..                                         
--                       %@@@@@@@&##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&@@@@  ...,.,,,,,,,,,,,,,,,,,. ...                                             
--                         *&@@@&@&/&@@@@@@@@@@@@@@@@@##&@@@@@@@@@@@@@@@@@@@@@@@@@&(&@@(@      .................                                                   
--                    *@@@@@@@@@%@@@@#//@@@@@@@@@@@@@@@@@@&@#*((((@@@@@@@@@@@@@&###@###@                                                                           
--                %@@@@@@@@@@#@@@&&&&&#/***/&&&&,,....(#&&&&,,..#@@@@*(((&@@%#/(*/(##(                                                  .,/#%%#                    
--            %@@@@@@@@@@@%@@&&&&%**********(,,,.. .,(#####,,..@@@@/###&&&&&&%%%%#(&&(                                         .%@@@@@@@@@@@@@@@@@@#               
--         &@@@@@@@@@@@%@&&&&#*************,,,,. ..##(/##(*,.(@@@@/##&&&@@@@&&&&&&&@                                      ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@/           
--       (@@@@@@@@@@#@&&&#***/********,*,,,,. ...########**.(@@@@/#@@@@@@@@@@@@@@@@                                   /@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/        
--      @@@@@@@@@@@@&&,/////*******,,,,,,......(#(###&&&**.@@@@@((@@@@@@@@@@@@@@@@%,                              .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      
--     @@@@@@@@&@@&//////////*,,,,,,,,.*,...**(#&&&@&&&**,&@%@@@((@@@@@@@@@@@@@@@@@@@                          &@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@    
--    &@@@@@@(@&/////,*,,,,,......,.*,,,.*///#&#&&&@&&&**@&@&@@@(&@@@@@@@@@@@@@@@@@@@@                     .@@@@@@@@%(*****/%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   
--   ,@@@@@@&//////..,,,,,,......*/.,,.//////&&&#@@@@&,*,@@@@%@@(&@@@(@@@@@@@@@@*@@@@@@               ,&@@@/////////////              *&@@@@@@@@@@@@@@@@@@@@@@@@@* 
--   @@@@@///////....,,,,,,. ,////,,,.///////&&&&&&@&,,*&&&@&&&@#(@@@@##&&&&&&&#(@@@@@@          %@@@&/////////////////,                   *@@@@@@@@@@@@@@@@@@@@@@ 
--  (@@@((/////,.....,../////////.,,.///////%&&@&&&&,.,*&&&@@@@&@(%@@@&####&&#(#&@@@@@@,     @@@@&/////////////////////                        (@@@@@@@@@@@@@@@@@@#
--  @@@*(((((/,. .. ////////////,,,.////////&&&&&&&,,%,,&&@@@@&&%@(@@@@@/#####%&&&&@@@@(,@@@@@*///////////////////////,                           /@@@@@@@@@@@@@@@@
--  @@/((((((,,..,/(////////////,..////////&&&&@&@&,.&/,&@&@@@&@&#@#@@@@@@%(%&&&&&#@@@@@@@@////////////////////////(((                               @@@@@@@@@@@@@@
--  @%(((((((...((((((((////////,.////////(&&&&&&&#,(&&,&&&@&&&&&@&@@@@@@@@@@@@@@@@@@@@&///////////////////(((((((((((                                 @@@@@@@@@@@@
--  @((((((((,((((((((((((((((/((/((///((&&#&&&&&&&,#&&&,&&@&&&@&&&@&&@@@@@@@@@&(. ,///////(///(/(((((((((((((((((((((                                   @@@@@@@@@@
--  &((((((((((((((((((((((((((((((((((((&&#&&&&&&&(*&&&&*&@&&&&#####&@&             (((((((((((((((((((((((((((((((((                                    (@@@@@@@@
--  #((((((((((((((((((((((((((((((((/  %@@%/@@@@@@@(&@@@@%@&####(@@@@(&              *((((((((((((((((((((((((((((((/                                      @@@@@@@
--  ((((((((((((((((((((((*           *&&&&&#%&&&&&@%&&&&####(&&&&&@((&@@.              (((((((((((((((((((((((((((((                                        @@@@@(
--  ((((((((((((((((((((.            .&(&&&@&(&@&(#(###*#(@@&&&@&##(&&&@##               ,((((((((((((((((((((((((((*                                         @@@@ 
--  *(((((((((((((((((                #&##(&&&&&&&#@&&&&&&&&##(#&&&@&&&&#&,#                (((((((((((((((((((((((*                                           @@& 
--   (((((((((((((((,                /&%&&###&&@&%######(/&@&@&&#/,(#&&&..%%#                 ,(((((((((((((((((((.                                            .@  
--   ((((((((((((((                  &&%./&&&##(&&&@&&(*(#(##(##(##,..@&%,.%(..                   *#(((((((((((/                                                .  
--   /(((((((((((/                   /&%%./#%%%%@&@@&&%*/(#%%%,.%%&@@@@&%#    ..                                                                               /   
--    ((((((((((*                   ..    .#%%%%&&%%%##(((#%%%%.*%%&&*.      .....                                                                                 
--    (((((((((*                    ..,.         *(((//*...                 . .....                                                                                
--     /((((((/                     . ,.                                   .   .....                                                                               
--      *((((#                      ...                                           ...                                                                              
--        (((.                      ..,.              .  .                         ...                                                                             
--         ((                        .,.                                         ......                                                                            
--                                   .,..                  .                  ... ......                                                                           
--                                   ..,....                 .         ....... ..........                                                                          
--                                    .,...............    .    .         ................,                                                                        
--                                     .............. ..    .     ..........................                                                                       
--                                      ,,..............    .       ..........................                                                                     
--                                      ..,.............    .         ,........................                                                                    
--                                       .,.............    ..          ........................                                                                   
--                                        ,,..............                 ......................                                                                  
--                                         ,,.............   .               .....................                                                                 
--                                          ,,............   .                  ....................                                                               
--                                           ,,...........   .                    ...................                                                              
--                                            ,,...........  .                      .................,                                                             
--                                             ,............ .                         ................                                                            
--                                              ,.............,                          ...............                                                           
--                                               ,..........  .                            ,.............                                                          
--                                               .,.......   ..                              .............                                                         
--                                                ........    .                                .............        

-- Disclaimer: These testcases was written by a shitty programmer and may be wrong. 
--             Use at your own risk.


module TestE3 where

import E3
import Test.HUnit

{- Test E3 -}

testInterleave = TestList [testInterleaveLong, testInterleaveEmpty1, testInterleaveEmpty2]
testInterleaveLong = TestCase $ assertEqual
                       ("\ninterleave [42, 45] [24, 98, 567]:") [42, 24, 45, 98]
                       (interleave [42, 45] [24, 98, 567])

testInterleaveEmpty1 = TestCase $ assertEqual
                       ("\ninterleave [42, 45] []:") []
                       (interleave [42, 45] [])

testInterleaveEmpty2 = TestCase $ assertEqual
                       ("\ninterleave [] [24, 98, 567]:") []
                       (interleave [] [24, 98, 567])


testToPairs = TestList [testToPairsLong, testToPairsEmptyInfinity]

testToPairsLong = TestCase $ assertEqual
                     ("\ntoPairs [42, 45, 56] [24, 98]:") [(42, 24), (45, 98)]
                     (toPairs [42, 45, 56] [24, 98])

testToPairsEmptyInfinity = TestCase $ assertEqual
                     ("\ntoPairs [1..] []:") True
                     (null (toPairs [1..] []))


testRepeat = TestList [testRepeatZero]
inc x = x + 1
testRepeatZero = TestCase $ assertEqual
                    ("\nrepeat' inc 8273958 0:") [8273958]
                    (repeat' inc 8273958 0)

stupidIncSet l = l <> [length l]
testRepeatList = TestCase $ assertEqual
                    ("\nrepeat' inc 8273958 0:") [[], [1], [1, 2], [1, 2, 3]]
                    (repeat' stupidIncSet [] 3)

subset s t = all (`elem` t) s
sameSets s t = (length s == length t) && (s `subset` t) && (t `subset` s)

testNumNeg = TestList [testNumNegZero, testNumNegEmpty]
testNumNegZero= TestCase $ assertEqual
                    ("\nnumNeg [0]:") 0
                    (numNeg [0])
testNumNegEmpty = TestCase $ assertEqual
                    ("\nnumNeg []:") 0
                    (numNeg [])

testGenSquares = TestList [testGenSquaresOddEven, testGenSquaresEvenOdd, testGenSquaresEvenEven, testGenSquaresOddOdd, testGenSquaresEmpty]

testGenSquaresOddEven = TestCase $ assertEqual
                        ("\ngenSquares 5 6:") [36]
                        (genSquares 5 6)

testGenSquaresEvenOdd = TestCase $ assertEqual
                        ("\ngenSquares 6 7:") [36]
                        (genSquares 6 7)

testGenSquaresEvenEven = TestCase $ assertEqual
                        ("\ngenSquares 6 8:") [36, 64]
                        (genSquares 6 8)

testGenSquaresOddOdd = TestCase $ assertEqual
                        ("\ngenSquares 5 7:") [36]
                        (genSquares 5 7)

testGenSquaresEmpty = TestCase $ assertEqual
                        ("\ngenSquares 5 5:") []
                        (genSquares 5 5)

testTriples = TestList [testTriplesInclusive, testTriplesEmpty]

testTriplesInclusive = TestCase $ assertEqual
                     ("\ntriples 5:") True
                     (sameSets (triples 5) [(3,4,5)])

testTriplesEmpty = TestCase $ assertEqual
                     ("\ntriples 1:") True
                     (sameSets (triples 1) [])

tests = TestList [testInterleave,testToPairs,testRepeat,testNumNeg,testGenSquares,testTriples]
main = runTestTT tests
